<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="feed" href="/feeds/all.atom.xml" title="Articles">

    <title>Cross-Validation Gone Wrong - Tim Head</title>


    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <!-- Bootstrap -->
    <link href="/theme/css/bootstrap.css" rel="stylesheet">

    <link href="/theme/css/pygments/default.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-49540142-1', 'betatim.github.io');
      ga('send', 'pageview');
    </script>

    <!-- extra stuff for nbconvert -->
	
<style type="text/css">
    .highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}
div.prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}
</style>

<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>

    <!-- extra stuff for nbconvert -->

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/javascript">
      init_mathjax = function() {
      if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        },
        displayAlign: 'left', // Change this to 'center' to center equations.
        "HTML-CSS": {
          styles: {'.MathJax_Display': {"margin": 0}}
        }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
      }
      }
      init_mathjax();
    </script>

    <link href='https://fonts.googleapis.com/css?family=Roboto:400,400italic,700&subset=latin,latin-ext' rel='stylesheet' type='text/css'>

    <style>
      .cell {
      margin-top: 22px;
      margin-bottom: 11px;
      }
      .text_cell_render {
      padding: 0;
      }
      .title {
      border-left: 7px solid #eee;
      padding: 10px 10px 10px 23px;
      margin-left: -30px;
      }
      .when {
      padding-top: 5px;
      text-transform: uppercase;
      color: #777;
      }
      .entry-content img {
      border-radius: 4px;
      }
      .navbar {
      margin: 75px 0 25px 0;
      }
      .footer {
      margin: 100px 0 25px 0;
      border-top: 1px solid transparent;
      border-color: #eee;
      }
      .powered-by {
      padding: 15px;
      float: right;
      }
      .social {
      padding: 15px;
      float: left;
      }
      .social i {
      padding-left: 15px;
      }
      .social a {
      color: black;
      transition: all 0.25s ease-in;
      -webkit-transition: all 0.25s ease-in;
      }
      .social a:hover {
      text-shadow: 0 0 15px #000;
      }
      .listing span {
      float: right;
      text-transform: uppercase;
      }
      .listing li {
      list-style-type: none;
      }
      .navbar a {
      transition: color 0.5s ease-in;
      -webkit-transition: color 0.5s ease-in;
      }
      .navbar li a {
      font-weight: bold;
      }
      .navbar a {
      text-transform: uppercase
      }
    </style>

  </head>
  <body>
    <div class="container">
      <div class="row">
	<div class="col-md-8 col-md-offset-2">
	  <nav class="navbar navbar-default" role="navigation">
	    
	    <!-- Brand and toggle get grouped for better mobile display -->
	    <div class="navbar-header">
	      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
		<span class="sr-only">Toggle navigation</span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
	      </button>
	      <a class="navbar-brand name" href="http://betatim.github.io/">Tim<b>Head</b></a>
	    </div>
	    <div class="collapse navbar-collapse navbar-right">
	      <ul class="nav navbar-nav">
		<!-- <li><a href="#">Notes</a></li> -->
		<!-- <li><a href="#">Talks</a></li> -->
                         <li><a href="/pages/about.html">
                             About
                         </a></li>
                         <li><a href="/pages/science.html">
                             Science
                         </a></li>
                         <li><a href="/pages/sports.html">
                             Sports
                         </a></li>
	      </ul>
	    </div>
	    
	  </nav>  
	</div>
      </div>
    </div>
    
    <div class="container">
      <div class="col-md-8 col-md-offset-2">
    <section id="content">
        <article>
            <header class="title">
                <h1>
                    <!--<a href="http://betatim.github.io/posts/cross-validation-gone-wrong/"
                       rel="bookmark"
                       title="Permalink to Cross-Validation Gone Wrong">
                        Cross-Validation Gone Wrong
                    </a>-->
		    Cross-Validation Gone Wrong
                </h1>
		<div class="when">04 April 2015</div>
            </header>
            <div class="entry-content">
                <p>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Every time you want to use machine learning to solve a challenge you face a problem: Choosing the input features, classifier type, ... and then estimating your new model's performance. Simultaneously it is one of the most important steps as the difference in performance can be quite different for different models, so optimising your choices matters.</p>
<p>A universially used technique to help with this task, called model selection, is cross-validation. Using cross-validation is an excellent idea, but as with everything there are some traps waiting for you.</p>
<p>This post is about some of traps and how to avoid them.</p>
<p>As usual, first a few imports:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">



<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre><span class="o">%</span><span class="k">matplotlib</span> <span class="n">inline</span>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">



<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">f_regression</span>


<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">6450345</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="feature-selection">Feature Selection</h2>
<p>Often selecting which features/variables to include in your model is part of the model selection step. Let's try it.</p>
<p>One strategy to select a subset of features is to evaluate how correlated each one is with the class labels and then choose the <span class="math">\(N\)</span> features with the largest correlation.</p>
<p>Let's create a dataset where the class labels are chosen at random:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">



<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre><span class="k">def</span> <span class="nf">make_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
              <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">n_vars</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>What does the correlation matrix between the different features and the class labels look like:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">



<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre><span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="n">n_vars</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">corrplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span>
             <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;var</span><span class="si">%i</span><span class="s">&quot;</span><span class="o">%</span><span class="k">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span><span class="o">+</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[4]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre class="ipynb tim">&lt;matplotlib.axes._subplots.AxesSubplot at 0x109f74f90&gt;</pre>

</div>
</div>

<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">


<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAFBCAYAAAB6hqiTAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAIABJREFUeJzt3Xl41NXZ//H3ZCaQlSUQoCxCC+GoRECqglgR3FoUEPv4
tCpYBGRTkAqoBKFADSibgKyyU6SLRS2KCvK0oiEKiLL6g4NQ1oIIJBCygJnM/P5ISEMkYMZJZsh8
Xtc1lzM53zPf+zZh7jnnfBeH1+tFRERCV1igAxARkcBSIRARCXEqBCIiIU6FQEQkxKkQiIiEOBUC
EZEQ57pco9fr9TocjvKKRUSkrOiD7DIuWwgcDgcnTpwtr1jKVHx8bIXJBSpWPsolOFW0XKRkmhoS
EQlxKgQiIiFOhUBEJMSpEIiIhDgVAhGREKdCICIS4lQIRERCnAqBiEiIUyEQEQlxKgQiIiFOhUBE
JMSpEIiIhDgVAhGREKdCICIS4oKyEHg8nkCHICISMoKmEBw6dIBDhw4CEBYWNGGJiFR4l70xTXnw
er088cTvyM39jrS0NB55pDvduvUobNMd0kREylbAC8HatasJCwsjKekPfPLJOubOnUl2djZ9+gzA
4XCoGIiIlLGAF4KoqGh27/5/OBwO+vV7itjYKsyZ8yq1atXmgQd+rSIgIlLGAlYI3G43LpcLY67l
zjvvZsSIZ5k4cRqPPvoY+/Z9zZdffs7993fB5QpsrfJ4PEyZ8jL79u0lPDyc4cNHUa9e/cL29es/
YenSBTidLu6/vwudO3ctbPvqq53MnTuDGTNeA2D//n8zceI4ABo0uIbnnx+J0+kMuvhL6mPtbiZP
Hk+lSpVJSGjK4MHDcDgc/OUvr/N//7eGsDAHjz3Wi3bt2gdl/EeOHGbcuDGEhYXx0582ZujQ53E4
HLz++hL++c8PiY6O4dFHf0fbtr8gMzOT0aNHcO5cDuHh4fzhDy8SF1fDb3ldLv6iTp8+zdixL/Dd
d99Rs2ZNRowYTeXKESX269WrG9HRMQDUrVuPpKQ/sGfPbp5/fgj16zcAoGvXh7jrrnv8nos/87tg
woRxVK1alf79B5ZLvKEqIKuyF4pAenoa/fr1pEkTQ7169XnmmafYuPEz3O5czp07F4jQviclZR25
ubnMnbuI/v0HMXPm1MI2t9vNzJlTmTp1NjNnzuOdd94iPT0NgOXLlzJxYjK5ubmF28+bN5v+/Qcx
Z85CAFJTU4Iy/pL6TJw4jsGDn2XWrPlER8ewdu1qzp49y4oVf+W11xbzyiuzePXVKUEb/4wZr9Cv
31PMmjUf8JKS8jH79u3l//7vQ+bNW8orr8xkwYK5nD9/jvfff5cmTRKYNWs+d911L3/+8zK/5nW5
+ItasmQ+997bkVmz5pOQYFi58q0S+qVz/vz5gjxfY8aM10hK+gMA1u7mt799tPDn5VUEfM3vgn/8
403279+nWYFyEJBC4HK5OHXqJEOHPs311yfSrdvveOqp3/Pzn9/M5Mkvs3//v3niif4BHw0AbN++
jdat2wLQrFkiu3fvKmw7cGA/9eo1ICYmBpfLRfPmLdm69UsA6tdvwLhxk/B6vYXbjxs3kRYtWpKb
m8upU6eIiYkJyvhL6nPy5LckJt4AQGJic7Zv30pkZCR16vyEnJwcsrOz/H7Elz/j37PH0rJlKwDa
tGnL5s0bOXjwADfe+HPCw8OpVKkSDRo0YO/evTRpkkBWVhYAmZmZhIeH+zWvy8VfPP82bdoWxHwb
mzdv4uDBA5fo9wV7937NuXPnGDJkIIMHD+Crr3YCYO0uPvsslYED+/Lyyy+SnZ3t91z8mR/Ajh3b
2LXrKx544NcX/RuSslGun7R5eXmFUyHp6ekcPLifzMyzHD58iGuvvY4xY8Zx4sS3VK4cQZUqVcoz
tBJlZ2cRHR1d+DosLAyPx0NYWBhZWVnExPy3LSoqmqysTADuuONOjh07etF7hYWF8c03x/j9758i
NjaGJk0SgjL+S/XJy8ujbt16bN36JS1btiI1NaVw1BYfX4vu3f8Xj8fDY4/1DNr4i36gXNi2ceMm
vP76YrKzs8nN/Y4dO7bzwAP/Q2xsFT7/fAPdu/+Gs2czCkYR/nW5v5+L88//whAZGUlmZiZZWZmX
7BcZGcGjjz5Gp05dOXz4EMOGPc2f//wm11+fSJcuD9K06bX86U+LWLx4Pk89Ndjv+fgrv1OnTrJ4
8QJeemkS//zn2jKPU8qxEBSdDtq5czs/+1kT5s1bypAhA5k+fTKDBw+jYcNGxMfXKq+QfpCoqOiL
vkF5vd7Cb70xMTEXtWVnZxEbe/kCVqfOT/jrX99i1ap/MGPGVF54YUyZxH1BaeOPiYm9ZB+n00lS
0mimT5/C4sULaNGiJVlZmWzY8ClpaadYseJdvF4vQ4YM5IYbmnPddc2CLv6io5X8D9NYGjZsxK9/
/RuGDh1E7dp1uP76RKpUqcqiRfPo1q0HXbo8yL59e3nhhedYuvQvfslp/vw5bN++lX379nL99f/9
/3Spv5/8D88sKlWqRHZ2NjExsURHX/rvrkGDhtSrl78O0KDBNVSpUpW0tFO0a9ehcPR5++3tmTZt
sl/yKKv8Pvro/zhz5jTDhg0mLe0U586do2HDRnTs2KlM4w5l5TI15PV6cblcHD36Hx577DeMHTuS
5OTRpKWdYvLkV9my5QvmzHn1ovn0YNG8eQs2bEgFYOfOHTRu3KSwrWHDRhw+fJiMjAxyc3PZunUL
zZo1L/G9hg8fwpEjhwGIjIwqlxPnSht/YmKLEvt89tl6Ro9+kenTZ5ORcYabb25DbGwVKleuXDi1
EhsbS2Zm5vcDCYL4ExKasmXLFwBs2PApLVq04vTp02RnZzNnzkKGDUvi22+P87OfNaZKlSqFo4pq
1aqRnZ3lt5z69BnAjBmv8c47azhy5Mhl/36K5rJhw6e0bHljiX937723kpkzpwFw8uQJcnKyiYur
wZAhA9m16ysAvvhiE9dee53fcimL/B566GEWLlzGjBmv0b3749xzz69UBMqY4wrzb94TJ87+qB1c
mA7Kzs4iKWkYTZteS0JCU2bNmkajRo3p2vXXNGr0M5xOJ9dc0/BH7ety4uNj8SUXr9dbcATK1wAk
JY3G2l3k5OTQpcuDpKamsGTJfDweL506PcCDDz5U2PfYsaOMHTuSuXMXAbBz53ZmzZpOeHg4ERGR
DB8+0ucjUX5oPr7Ef6k+11zTkNTUFBYsmENERAStWt1Mnz4DAFi48DU2bvyMsLAwmjdvyZNPPu23
XPwZ/+HDh5gwIRm3202jRj/l+edH4nA4mDRpPHv27MblCqd//0G0aNGSkydPMmHCi+Tk5OB2u3ni
if7cdNMtPyqXS7lU/BkZZ5gwIZlx4yaRnp5GcvIYsrOzqFatOmPGJFO5csQl+7ndbsaNG8Px49/g
cDgYMOBpEhNvYM+e3UydOgmXy0WNGjV57rkXiIqK8nsu/szvgg8+WMWhQwfp1++pHxVHfHysVpwv
o8wLAcCpUycZN24MN910Cy6Xi40bN9C69a0sWjSPJk0SGD9+cpmvCfjjjzqYVKR8lEtwqmC5qBBc
RpnNTeTl5RU+z87OZseObeTk5BAZGUVMTAznz5+jXr36jBgxOmgWhkVEQlGZLRY7nU4yMjI4fvwY
CQmG1q1vJTMzk4YNG5GSso4dO7YxYcIr1K1br6xCEBGRH6DMCoHb7WbUqOHs2vUVPXv2oU6duqxc
+RaPP96b5ctXEBERQfXqcWW1exER+YHKrBC4XC6SkkaxefNGli1bQnx8Lc6dy+Htt1fQo0dvnS0o
IhIkyvQ8gjp1fkKnTl1p2/Z2DhzYz6pVK+nQ4W4VARGRIFIuJ5TFxdUgLq4GrVrdVB67ExGRUtCt
wEREQpwKgYhIiFMhEBEJcYG/zrOIyFXqvXBTqmtk359rg/JIGY0IRERCnEYEIiI+coQH5Rf8UlMh
EBHxkTOybO85Xl5UCEREfBTm0ohARCSkaWpIRCTEaUQgIhLiNCIQEQlxGhGIiIQ4h1OFQEQkpIWp
EIiIhDZHWIgUguiv3i2POMpe+0cDHYGIVDDOSv47ocwYEwbMBpoD54EnrLX7irR3BkYBbmCRtXZB
kbZawBfAXdbaPaXd9xULQVQF+gCNj48NdAh+VZHyUS7BqSLlUhb8PCLoClSy1rY1xrQGphT8DGNM
OPAKcBOQDaQaY96x1n5b0PYakOXrjq9YCLLX/dnX9w4qUe0f5cSJs4EOw2/i42MrTD7KJThVtFzK
gp/XCG4DVgNYazcaY4re0vE6YK+19gyAMWY90A5YAUwC5gBJvu5YVx8VEfGRw+ko1eMKqgAZRV7n
FUwXXWg7U6TtLFDVGPM4cMJa++GFkHzJQ4VARMRHjrCwUj2uIAMoOnQJs9Z6Cp6fKdYWC5wGegL3
GGM+AloCS40xtUubh44aEhHxkZ/XCFKBzsDfjTFtgO1F2nYDCcaY6uSvBbQDJllr37ywQUEx6Get
PV7aHasQiIj4yM9rBG+T/+0+teB1T2PMI0CMtXa+MWYIsIb8mZyF1tpj/tqxCoGIiI/8OSKw1nqB
AcV+vKdI+ypg1WX6d/B13yoEIiI++gHz/lcFFQIRER85w1UIRERCWshcYkJERC5NU0MiIiFOIwIR
kRCnQiAiEuJUCEREQpzWCEREQlxFuUNZxShnQcbr9fL116W+N4SIXGUcYY5SPYKVCkEZWLBgLr16
dWPHjm2BDkVEylCYy1mqR7BSISgDYQXzhiNGPMuXX24OcDQiUlY0IpDvycvLw+12k56exkMPPUyL
FjfywgvPsWXLF4EOTUTKgJ/vRxAwwRvZVSYvLw+n04nL5aJ9+7to1iyRoUOf54YbWvCHPyTx+ecb
Ah2iiPhZRRkR6KghP3C73bhcLk6dOkmvXt2YNGk6N910CwBDhz7Piy/+gYkTx7Ns2RtEREQELE6P
x8OUKS+zb99ewsPDGT58FPXq1S9sX7/+E5YuXYDT6eL++7vQuXNX8vLymDAhmcOHD+FwOBg2LImf
/awx1u5m8uTxVKpUmYSEpgwePAyHo2z/0H2Jv6Q+e/bs5vnnh1C/fgMAHnzwf7nzzrt58803WL16
FeDgkUce48477y7TnHzN64KvvtrJ3LkzmDHjNYDv5dW160Pcddc9ZZ5DWeQyevQI0tJOAXDs2FES
E5szZsy4csvlhwjmb/mloULgBxeKwPPPD+H66xP56U8bF7bVrl2H0aOT8Xg8AS0CACkp68jNzWXu
3EV89dVOZs6cyksvTQHyi9nMmVNZsGAZERERDBjQi1/8oh07dmwnLCyMOXMWsmXLF8yfP5uXXprC
xInjeOaZ50hMvIH58+ewdu1q7r23Y9DFv3371kv2sXY3v/3tozz8cPfC9z99+jQrV77J4sV/5vz5
83Tv/r/lUgh8yat69TiWL1/Khx9+QGRkVOF7XSqv8uTPXMaOHQ/A2bNnefrpfjz99JCA5HRZZfzl
p7xUjHIWIHl5eYXP09PT2b9/H/v37+fw4YMXbRcfX4vateuUd3jfs337Nlq3bgtAs2aJ7N69q7Dt
wIH91KvXgJiYGFwuF82bt2Tr1i9p1649zz47AoBvvjlGbGwVAE6e/JbExBsASExszvbtW4My/pL6
WLuLzz5LZeDAvrz88otkZ2dTrVo1liz5C06nk1OnTlKpUuUyz8nXvADq12/AuHGT8Hq9hdtbu/t7
eZUnf+ZywcKFc3nooYeJi6tRPkmUQkWZGlIh8JHb7cbpdJKenkZKyjoiIyOZN28pOTnZzJr1KgcP
Hgh0iN+TnZ1FdHR04euwsDA8nvx7Y2dlZRET89+2qKhosrIyAXA6nSQnj2batEncc8+vAKhbt17h
P+LU1BRycnKCMv5L9cnLy+P66xN56qnBzJw5j7p167F48fzC9jff/Bv9+/fkV7+6r8xz8jUvgDvu
uBOn8+JDEq+/vtkl8yov/swFID09jS+++Jz77utcxpH7xp+LxcaYMGPMXGPMp8aYj4wxjYu1dzbG
bCpof6LgZ05jzCJjzHpjTIoxppkveagQ+MDr9eJyuTh69D889thvGDt2JMnJo0lLO8Xkya/y5Zef
M2fOq7jd7kCHepGoqOiLviF6vd7CQ11jYmIuasvOzir89g8wcuRY/vKXt5gwIZnz58+RlDSaZcuW
MHjwk8TFxVGtWrWgiz8mJvaSfZxOJ7ff3p6mTa8F4Pbb27Nnjy3c5n/+57esXLmGLVu+LJfDf3/M
76W4du06lJhXefBnLgAfffRP7r23Y5mvP/nKzyOCrkAla21bYDgw5UKDMSYceAW4B7gD6GuMqUX+
ze491tpfACMBnxZRVAhKKS8vD4fDQXZ2FhMmJNOxY2eee+4Fjh49wuuvL+XIkUMsWrScJ58cjMsV
XEswzZu3YMOG/Pti79y5g8aNmxS2NWzYiMOHD5ORkUFubi5bt26hWbPmrFnzPsuWLQGgcuXKBf+o
HXz22XpGj36R6dNnk5FxhptvbhN08Scmtiixz9Chg9i16ysAvvhiE9deex2HDh3khReeBfJHQZUq
hV/yW2qg82rWrHmJ7zVkyMDv5VWe/JkL5OfQpk3bMo35x/DzCWW3AasBrLUbgZuKtF0H7LXWnrHW
5gLrgXbW2n8A/Qq2aQSk+5JHcH1SXQUuzB+PGzeG1q1vxeVysWbNB3Tr9jiLFs3jzTffYPz4yVSp
cvlvOoHQrl0HPv98IwMG9AIgKWk0a9euJicnhy5dHmTQoGcYOnQgHo+XTp0eoGbNmtxxx52MHz+W
gQP74na7efrpoVSuXJn69a9h8OABRERE0KrVzeXyj9WX+C/VB2DYsOFMnToJl8tFjRo1ee65F4iK
iqJJk6b069cTh8NBmzZtadHixqDMq6ii35YvlVd58mcuAIcOHaRu3XrlFn9p+XnevwqQUeR1njEm
zFrrKWg7U6TtLFAVwFqbZ4xZSv6I4iFfduy41OJMEd7sdX/25X2DTlT7Rzlx4qzP/S+cJwBw+PAh
evXqxsMPd6dWrdps3ryJJk0SWLfuX7z44svl8ocbHx/7o/IJJsolOFWwXMpkbunbFx6/7AdocbXG
LSkxDmPMFGCDtfbvBa8PW2sbFDy/AXjZWnt/wetXgPXW2reK9K8NbASus9aWatFOI4IfyOl0kpGR
wfHjx0hIMLRufSuZmZk0bNiIlJR17NixjQkTXgnqby8i4l9+XrtIJX/O/+/GmDbA9iJtu4EEY0x1
IAtoB0wyxnQH6ltrXwZyAE/Bo1RUCH4gt9vNqFHD2bXrK3r27EOdOnVZufItHn+8N8uXryAiIoLq
1eMCHaaIlCM/n1D2NnCPMSa14HVPY8wjQIy1dr4xZgiwhvy13YXW2mPGmLeAxcaYj4FwYLC19nxp
d6xC8AO5XC6SkkaxefNGli1bQnx8Lc6dy+Htt1fQo0fvoD2qQUTKjj/XCKy1XmBAsR/vKdK+ClhV
rE828Nsfu28VglKoU+cndOrUlbZtb+fAgf2sWrWSDh3uVhEQCVW6xEToiourQVxcDVq1uunKG4tI
hRXMZwuXhgqBiIiPHA6NCEREQpojiO86VhoqBCIiPtLUkIhIqNPUkIhIaNOIQEQk1OnwURGR0FZR
ziFSIRAR8ZVGBCIioU1rBCIioU5HDYmIhDZHOdzBrjyoEIiI+EpTQyIioc3P9yMIGBUCERFf6fBR
EZEQpxGBiEiI8+OIwBgTBswGmgPngSestfuKtHcGRgFuYJG1doExJhxYBDQEKgPJ1tp3S7vvilHO
REQCwBEWVqrHFXQFKllr2wLDgSkXGgo+8F8B7gHuAPoaY2oB3YAT1tp2wK+Amb7kccURQVT7R315
36AUHx8b6BD8qiLlo1yCU0XKpUz49zyC24DVANbajcaYordAvA7Ya609A2CMWQ+0A/4OrCjYJoz8
0UKpXbEQnN30vi/vG3Rib7mP7ffdEegw/Kb5+x9z4sTZQIfhF/HxscolCFW0XMqCn88jqAJkFHmd
Z4wJs9Z6CtrOFGk7C1S11mYBGGNiyS8KL/iyY60RiIj4yr/nEWQARSvWhSIA+UWgaFsskA5gjGkA
vAXMstb+1ZcdqxCIiPjKv1NDqUBn4O/GmDbA9iJtu4EEY0x1IIv8aaFJxpjawIfAk9baj3zdsQqB
iIiv/HsewdvAPcaY1ILXPY0xjwAx1tr5xpghwBry1wIWWmuPGWOmA1WBPxhj/lDQr6O19lxpdqxC
ICLiKz+eR2Ct9QIDiv14T5H2VcCqYn0GA4N/7L5VCEREfKWrj4qIhDhddE5EJMRpRCAiEuJ00TkR
kRCnG9OIiIQ4TQ2JiIQ4XYZaRCTEaY1ARCTEaWpIRCTEaUQgocjr9eKoIH/8Ij+a1ggkFHi9XjZt
2kB4eDitWt2Ew+FQMRAp4K0g/w5UCKREXq+XHj0exuPxcPDgAXr27EOvXn1VBEQuqCBrBBUjCykT
b7zxZypVqszMmfPp3v1xVq1ayTfffIPX6w10aCJBwRvmLNUjWGlEICXKy8vjzJnTREVF0bhxE9LT
03A6w3A4HHg8HsIqyPyoiM8qyIhAhUC+x+1243K5uPHGn9Ohw91UqlSJqKho3G430dHRLFz4Gk6n
kx49emuaSEJbBfn7VyGQi1woAqdPnyYpaRgvvTSZn/ykLuHhLuLi4njllYmsWfM+c+cuDmgR8Hg8
TJnyMvv27SU8PJzhw0dRr179wvb16z9h6dIFOJ0u7r+/C507d8XtdvPSS2P55ptv+O677+jRoze/
+EU7rN3N5MnjqVSpMgkJTRk8eFhAcrtUzEWdPn2asWNf4LvvvqNmzZqMGDGaypUjSpWrP/nyOyip
z5Ejhxk3bgxhYWH89KeNGTr0eRwOB3/723L++c+1ANx662307Nmn8P0//vgj1q37J6NHJ/s1r1Lx
46jYGBMGzAaaA+eBJ6y1+4q0dwZGAW5gkbV2QZG21sDL1toOvuy7YoxrxG9cLhenTp1k6NBBXHfd
9TRp0hQAp9NFWloan3yyjkWLXqdZs8SAxpmSso7c3Fzmzl1E//6DmDlzamGb2+1m5sypTJ06m5kz
5/HOO2+Rnp7Ghx9+QLVq1Zk1az5Tpsxg6tSJAEycOI7Bg59l1qz5REfHsHbt6nLPp6SYi1qyZD73
3tuRWbPmk5BgWLnyrVLn6k++/A5K6jNjxiv06/cUs2bNB7ykpHzM0aP/Ye3aNbz22mLmzVvCpk0b
+Pe/9wIwbdpk5s2bFfD1Kq/DUarHFXQFKllr2wLDgSkXGowx4cArwD3AHUBfY0ytgrbngPlAZV/z
UCEQIH894IL09HQOHPg3+/fv59Chg3i9XmrXrsNNN93CvHlLSEgwAYw03/bt22jdui0AzZolsnv3
rsK2Awf2U69eA2JiYnC5XDRv3pKtW7+kQ4e76d27PwBerweXK39AfPLktyQm3gBAYmJztm/fWs7Z
lBxzUdu3b6NNm/yc27S5jc2bN3Hw4IEflKuzDK6S6cvvoKQ+e/ZYWrZsVZBbWzZv3kitWrWZMuXV
wtGZ2+2mUqX8z7obbmjB0KHDA14IcISV7nF5twGrAay1G4GbirRdB+y11p6x1uYC68m/gT3AXuDX
gM/DWBUCwe1243Q6C7+xRUZGMm/eUnJyspk9+1WOHDlMvXr1+eMfX6ZRo58GOlwAsrOziI6OLnwd
FhaGx+MBICsri5iY/7ZFRUWTlZVJZGQkUVFRZGdnMXLk8/Tpk3972Lp16xV+6KamppCTk1OOmXDZ
mIvKzzkGgMjISDIzM8nKyrxirqNGDadv3yf9HrMvv4NL9cnLy7voAz0yMoqsrExcLhdVq1bD6/Uy
c+Y0jLmW+vUbAHDXXff4PR9feB1hpXpcQRUgo8jrvILpogttZ4q0nSX/pvVYa98if7rIZyoEIc7r
9eJyuTh69D889thvGDt2JMnJo0lLO8Xkya/y5ZefM2PGVNxuN7GxsYEOt1BUVDTZ2dmFr71eb+FR
TDExMRe1ZWdnERtbBYDjx7/h6acH0LFjJ+6++5cAJCWNZtmyJQwe/CRxcXFUq1at3PKYP38Ogwb1
IylpKFlZWZeM+YL8D9OsgvZsYmJiiY6+cq6/+tX9hbn6U2l/BzExsZfs43Q6LzoC7cK2AOfPn2fs
2JGcO5fD0KHD/Z7Dj+ZwlO5xeRlA0X9kYdZaT8HzM8XaYoF0f6WhQhDC8vLycDgcZGdnMWFCMh07
dua5517g6NEjvP76Uo4cOcSiRcsZOPD3hdMowaJ58xZs2JAKwM6dO2jcuElhW8OGjTh8+DAZGRnk
5uaydesWmjVrTlraKYYMGciTTz7Nffd1Ltz+s8/WM3r0i0yfPpuMjDPcfHObcsujT58BzJjxGu+8
s4YjR458L+aiiua8YcOntGx5Y6lz9afS/g4SE1uU2CchoSlbtnxRmFuLFq3wer0kJQ0lIaEpw4Yl
BeURan4eEaQC9wEYY9oA24u07QYSjDHVjTGVyJ8W+sxfeQTXv24pV06nk1OnTjJu3Bhat74Vl8vF
mjUf0K3b4yxaNI8333yD8eMnU6VKlSu/WTlr164Dn3++kQEDegH53+rXrl1NTk4OXbo8yKBBzzB0
6EA8Hi+dOj1AzZo1mTZtMpmZmSxePJ/Fi+fjcDiYNGk69etfw+DBA4iIiKBVq5sL5+HLk8vlumTM
GRlnmDAhmXHjJtGjR2+Sk8fwzjtvU61adcaMSS6xX/FcASZPfpXKlX1eT/weX34Hl+oDMHDgM0yY
kIzb7aZRo5/Svv2dfPLJOrZu3YLb7WbDhk8B6NdvYOF6jsPhCHxx8O9JYm8D9xhjUgte9zTGPALE
WGvnG2OGAGvI/wK/0Fp7rFh/nxdMHFdYbPGe3fS+r+8dVGJvuY/t990R6DD8pvn7H3PixFmf+ubl
5RUuHh4+fIhevbrx8MPdqVWrNps3b6JJkwTWrfsXL774MnXr1vNn2JcUHx/rcy7BRrkEp/j42DKp
GBlfrCnVh2+Vn/8y+IY1aEQQkpxOJxkZGRw/foyEBEPr1reSmZlJw4aNSElZx44d25gw4ZVyKQIi
VzWdWSxNyWsYAAAXMElEQVRXK7fbzahRw9m16yt69uxDnTp1WbnyLR5/vDfLl68gIiKC6tXjAh2m
SNDz+n7EZlBRIQhBLpeLpKRRbN68kWXLlhAfX4tz53J4++0VumyESCn8gAXgq4IKQYiqU+cndOrU
lbZtb+fAgf2sWrWSDh3uVhEQKQ0VAqkI4uJqEBdXg1atbrryxiJyEd2YRkQkxGlqSEQk1GlEICIS
2jyO4L3rWGmoEIiI+EhTQyIioU5TQyIioc1bQa7bqUIgIuIjHT4qIhLitEYgIhLidK0hEZEQpxGB
iEiI0xqBiEiI0wllIiIhzp9rBMaYMGA20Bw4Dzxhrd1XpL0zMApwA4ustQuu1OeHqhgTXCIiAeDn
m9d3BSpZa9sCw4EpFxqMMeHAK8A9wB1AX2NMrYI+lS/VpzRUCEREfOTFUarHFdwGrAaw1m4Eil4b
/jpgr7X2jLU2F1gPtCvo80EJfX4wFQIRER/5eURQBcgo8jqvYOrnQtuZIm1ngapX6PODXXGNIPaW
+0r7nkGr+fsfBzoEv4qPjw10CH6jXIJTRcqlLPj5PIIMoOj/8DBrrafg+ZlibbHA6Sv0+cGuWAgO
7N1T2vcMSo2aNOXEzg2BDsNv4hPbcGpsn0CH4Rc1Rs/nxImzgQ7DL+LjY5VLECqrgubnw0dTgc7A
340xbYDtRdp2AwnGmOpAFvnTQpMA72X6/GA6akhExEder18LwdvAPcaY1ILXPY0xjwAx1tr5xpgh
wBryp/QXWmuPGWO+18eXHasQiIj4yJ9XH7XWeoEBxX68p0j7KmDVD+hTaioEIiI+8lSQ421UCERE
fKSLzomIhDgVAhGREOfnxeKAUSEQEfGRRgQiIiFOhUBEJMSpEIiIhDitEYiIhDiPRgQiIqHN49UJ
ZSIiIU1rBCIiIU5rBCJXOY/HQ1hYxRjaS2BoRCByFTp8+BAADRpcoyIgP5pGBCJXEa/XS58+PcjJ
ySYzM5NnnnmW9u3vKmxz+PcGIxIiSn0rsCClr0QSEv7xjzcJD3cxYsQY6tWrz6FDBzl16iQADocD
r9cb4AjlauT1Okr1CFYqBBIS8vLcpKefplmzRJxOJ++//y7duj3E/PlzADQiEJ94cZTqEaw0NSQV
mtvtxuVy0arVzbRvfzcAbdq0pVGjn7Fhw6d89lkqDz/cndhY3aRdSq+sv+UbYyKB14F44CzQw1p7
stg2fYC+gBtItta+V6TtQeAha223y+1HIwKpsC4UgfT0dIYMGcg33xwDoFu3Hlx77XVUrlyZqKgo
wsPDAxqnx+Nh0qTx9O/fi0GD+vGf/xy5qH39+k/o0+d39O/fi3ff/QeQn9uLL47iqaf60KdPD9av
/+SiPh9+uJr+/XuVWw4lxVnU6dOneeaZp3jqqT6MHp3E+fPnrtgvPT2NX//6fg4dOgjA119b+vZ9
nCeffIKXXvpjwKf08ryOUj18MADYZq1tB/wJGFm00RhTBxgEtAV+CbxkjAkvaJsOjIcrD0VUCKTC
crlcnDp1kmHDnua6667HmGsB+NvfltOnTw/+9a+1DBo0hIiIiIDGmZKyjtzcXObOXUT//oOYOXNq
YZvb7WbmzKlMnTqbmTPn8c47b5GensaHH35AtWrVmTVrPlOmzGDq1ImFffbs2c17771TrjmUFGdR
S5bM5957OzJr1nwSEgwrV7512X5ut5uJE8df9PtZvHgBvXr1ZfbsBeTm5vLpp+vLNc/iymFq6DZg
dcHz1cDdxdpvAVKttbnW2gxgL9CioC2V/EKiQiChJy8vr/B5eno6Bw78m/3793P4cP63yrvu+iXj
x0/mtdcWFxaHQNq+fRutW7cFoFmzRHbv3lXYduDAfurVa0BMTAwul4vmzVuydeuXdOhwN7179wfA
6/XgdDoBOHPmNPPmzWbw4CHl+m25pDiL2r59G23a5OfZps1tbN68iYMHD5TYb9as6Tz44EPUqFGz
8D2aNjVkZJzB6/WSnZ0V8NGcPxeLjTG9jTE7ij6AqkBGwSZnC14XFQucKfK6cBtr7Rs/NA8VAqlQ
3G43TqeT9PQ0UlLWERkZybx5S8nJyWbmzGkcOnSQmjVrcu211xEfXyvQ4QKQnZ1FdHR04euwsDA8
nvwDE7OysoiJ+W9bVFQ0WVmZREZGEhUVRXZ2FiNHPk/fvk+Sl5fHyy+/yKBBQ4iMjCrXHEqKs6j8
PGMAiIyMJDMzk6yszEv2e//9d6lWrRq33NKmoCW/qNWrV59p0ybTvfv/kp6eTsuWrco2sSvwekv3
uBxr7UJr7Q1FH+R/yF9YwIoFThfrllGk/cI26aXNQ4VAKgyv14vL5eLo0f/w2GO/YezYkSQnjyYt
7RSTJ7/Kli1fMHv2dHJzcwMd6kWioqLJzs4ufO31egtPdouJibmoLTs7i9jYKgAcP/4NTz89gI4d
O3H33b/E2l0cOXKYyZNfYsyYFzhw4N/MmPFKmcY+f/4cBg3qR1LSULKysi4Z5wX5H/JZBe3ZxMTE
Eh39/fxiYmJ5//13+fzzjQwa1I+vv95DcvIY0tJOMX36FGbPXsDy5Sv45S/vu2gaLRA8OEr18EEq
cF/B847AJ8XaNwG3G2MqG2OqAtcBO0u7Ex01JBVCXl4eTqeT7OwsJkxIpmPHziQkNGXWrGm8/vpS
unb9NYsWLcfpdAZ8OqG45s1bkJqawp133s3OnTto3LhJYVvDho04fPgwGRkZREZGsnXrFh555Hek
pZ1iyJCBDB06nFatbgLg+usTWbYsfzbgm2+OMXr0CAYNGlKmsffpMwDIH4l17/6b78VZPM8NG1Lp
2LETGzZ8SsuWN5aY34WT/QAGDerHs8+OIC6uBlWrViUqKn+0U6NGTXbu3F6m+V1JOZwbMAdYaoxJ
Ac4DjwIYY54B9lpr3zXGvAqkkP/FfoS19ruiIXJhOHUZKgRSITidTk6dOsm4cWNo3fpWXC4Xa9Z8
QLduj7No0TzefPMNxo+fTJUqVa78ZuWsXbsOfP75RgYMyD/KJylpNGvXriYnJ4cuXR5k0KBnGDp0
IB6Pl06dHqBmzZpMmzaZzMxMFi+ez+LF8wGYPPlVKleuDJT/2dIul+uScWZknGHChGTGjZtEjx69
SU4ewzvvvE21atUZMya5xH4lef75kYwePQKn00mlSpV47rmRJW5bHsp6GcZamwP85hI/n1rk+QJg
QQn9PwY+vtJ+HFdYUPIe2LvnisFeDRo1acqJnRsCHYbfxCe24dTYPoEOwy9qjJ7PiRNnfep7YSQA
+dcR6tWrGw8/3J1atWqzefMmmjRJYN26f/Hiiy9Tt249f4Z9SfHxsT7nEmwqWC5lUhU/3PZdqUrB
vS0qBeVZZRoRyFXN6XSSkZHB8ePHSEgwtG59K5mZmTRs2IiUlHXs2LGNCRNeKZciIKHHU0GuTKJC
IFc1t9vNqFHD2bXrK3r27EOdOnVZufItHn+8N8uXryAiIoLq1eMCHaZUUB5PUH7BLzUVArmquVwu
kpJGsXnzRpYtW0J8fC3Oncvh7bdX0KNHb11DSMqU7lksEiTq1PkJnTp1pW3b2zlwYD+rVq2kQ4e7
VQSkzFWUi9aqEEiFERdXg7i4GoWHU4qUtWC+tHRpqBCIiPhIi8UiIiFOU0MiIiEumG82UxoqBCIi
PtLUkIhIiNPUkIhIiMvTCWUiIqFNIwIRkRCnQiAiEuK0WCwiEuJ0ZrGISIjT1JCISIgr66khY0wk
8DoQD5wFelhrTxbbpg/QF3ADydba9wruX/w6+TezrwQMsdaWeGcu3bxeRMRHXm/pHj4YAGyz1rYD
/gRcdG9OY0wdYBDQFvgl8JIxphLwDLDWWtseeByYdbmdaEQgIuKjcpgaug2YUPB8NTCqWPstQKq1
NhfINcbsBZoDU8m/2T1AOJBzuZ2oEIiI+CjP47/3Msb0Bn5f7MfHgYyC52eBqsXaY4EzRV6fBapa
a88UvGcdYBkw+HL7ViEQEfGRx4+FwFq7EFhY9GfGmDfJ/7Cn4L+ni3XLKNJ+YZv0gr43AH8Bhlpr
Uy637ysWglN5Na+0yVWhERBz9P8FOgz/SWzDiW5/CHQUflEDiFwxPtBh+MeAlwIdgZSjcpgaSgXu
Az4HOgKfFGvfBIwzxlQGIoDrgJ3GmOuBvwP/a63dcaWdOLyXz6SCHBwlIiGuTA74n7O6dJ+RA35V
ujgKjhpaCvyE/Dn/R6213xpjngH2WmvfNcY8Qf5RQ2HAOGvt28aYf5C/VnCw4K1OW2sfLGk/VywE
X9i00sQdtH5u4sj5cFGgw/CbyHt7sXvv4UCH4RfXNmlA5pykQIfhFzEDXuLEibOBDsMv4uNjK1Iu
ZVIIZn1QukLwVMfgvIGB1ghERHx0hS/SlxCUdUCFQETEVzqzWEQkxPnzqKFAUiEQEfGRP88jCCQV
AhERH2lqSEQkxHlLfdU5LRaLiFQoujGNiEiI09SQiEiI81SQIYEKgYiIjzQiEBEJcSoEIiIhzlNB
KoEKgYiIjzx5KgQiIiGtolxiQjevF7kKeb1e3njjzxw8eOCin0n58nq9pXoEKxUCkavQmjXvM2PG
VFaufJMDB/YD4HAE51mrFZnHW7pHsNLUkMhVqFat2gB8+mkqlStHcOONP6d69eokJBi8Xq+KQjkp
/SUmSqfgDmWvA/Hk35i+h7X2ZLFt+pB/hzI3kGytfc8YEw38GagGfFfQ72hJ+9GIQOQqcmF6oUGD
a7j11tvo0uVBVqz4G0OHDmLv3q8BjQzKk9dbuocPBgDbrLXtgD8BI4s2GmPqAIOAtsAvgZeMMZWA
J4DPrbV3kF9InrvcTlQIRK4SeXl5OBwOsrIycTjCOHfuHLVr18HpDCM6OoZt27bwn/8cCXSYIcXj
8Zbq4YPbgNUFz1cDdxdrvwVItdbmWmszgL1Ac2vtdGB8wTYNgfTL7URTQyJXAbfbjcvlIi3tFD17
PsqLL07A4/Hwxz+O5Nlnk8jIOMuqVf8gIiIi0KEW8ng8TJnyMvv27SU8PJzhw0dRr179wvb16z9h
6dIFOJ0u7r+/C507dy1sS09Po3fvx5g2bTbXXNMwEOH/IP5cADbG9AZ+X+zHx4GMgudngarF2mOB
M0VeF25jrfUYY/4FNAPuvdy+VQhErgIul4tTp07y/PNDuP76G0hMbE7btr/gV7+6n06dHgCgU6cu
VKlS/HMicFJS1pGbm8vcuYv46qudzJw5lZdemgLkF7aZM6eyYMEyIiIiGDCgF7/4RTuqV4/D7XYz
ceL4oCpqJfH68fBRa+1CYGHRnxlj3iT/w56C/54u1i2jSPuFbQq//Vtr7zTGGOA9oElJ+9bUkEgQ
y8vLK3yenp7O/v37+Pe/93Ls2FEeffR3dOr0AG63G4DY2CqBCvOStm/fRuvWbQFo1iyR3bt3FbYd
OLCfevUaEBMTg8vlonnzlmzd+iUAs2ZN58EHH6JGjZoBibs08jyeUj18kArcV/C8I/BJsfZNwO3G
mMrGmKrAdcBXxpjhxpjuBdtkkb+QXCIVApEg5Xa7cTqdpKenkZKyjsjISObNW8q5c+eYMuXlwnMI
XK78gX2wLRJnZ2cRHR1d+DosLAxPwYdhVlYWMTH/bYuKiiYrK5P333+XatWqccstbQpagviYS8pl
jWAO0MwYk0L+AvBYAGPMM8aYztba48CrQArwT2CEtfY8sAjoZoz5iPyjh3pebieaGhIJQl6vF5fL
xdGj/6Fv3x6cO3eOhARDr159mTz5Vfr27cGcOa+SnDyxsBAEm6ioaLKzswtfe71ewsLyv3vGxMRc
1JadnUVMTCwrVvwNgM2bN/H113tITh7Dyy9PIS6uRnmG/oOV9Tli1toc4DeX+PnUIs8XAAuKtX9L
/gjiBwnOvyCREJaXl4fT6SQ7O4sJE5Lp2LEzCQlNmTVrGq+/vpSuXX/NokXLcTqdQVsEAJo3b0Fq
agp33nk3O3fuoHHj/05RN2zYiMOHD5ORkUFkZCRbt27hkUd+R/v2dxVuM2hQP559dkTQFgEo+/MI
ykvw/hWJhCin08mpUycZN24MrVvfisvlYs2aD+jW7XEWLZrHm2++wfjxk6lSJbjWBIpr164Dn3++
kQEDegGQlDSatWtXk5OTQ5cuDzJo0DMMHToQj8dLp04PULNm8K8JFKerj4qIX10YCQBkZ2ezY8c2
mjW7gVq1ahMTE8P58+eoV68+I0aMDvoiAPlrFsOGJV30s6KHgt522+3cdtvtJfafMeO1MovNXzQi
EBG/cjqdZGRkcPz4MRISDK1b30pmZiYNGzYiJWUdO3ZsY8KEV6hbt16gQ5UCKgQi4ldut5tRo4az
a9dX9OzZhzp16rJy5Vs8/nhvli9fQUREBNWrxwU6TCmigtQBFQKRYOFyuUhKGsXmzRtZtmwJ8fG1
OHcuh7ffXkGPHr2D7vBQ0YhARMpAnTo/oVOnrrRtezsHDuxn1aqVdOhwt4pAkMrLqxh3plEhEAlC
cXE1iIurQatWNwU6FLmMYL7ZTGmoEIiI+EhTQyIiIU6FQEQkxOmEMhGREKcRgYhIiNNisYhIiPPx
0tJBR4VARMRHmhoSEQlxniJ3kLuaqRCIiPhIU0MiIiGurBeLjTGRwOtAPHAW6GGtPVlsmz5AX/Lv
S5xsrX2vSNu1wAaglrX2u5L2o3sWi4j4yOvxlurhgwHANmttO+BPwMiijcaYOsAgoC3wS+AlY0yl
grYqwBTg3JV2okIgIuKjcigEtwGrC56vBu4u1n4LkGqtzbXWZgB7gebGGAfwGpAE5FxpJ5oaEhHx
kcfrv6uPGmN6A78v9uPjQEbB87NA1WLtscCZIq8vbDMaeM9au90YA3DZy9eqEIiI+Mifh49aaxcC
C4v+zBjzJvkf9hT893SxbhlF2otu0w04UlBc6gBrgPYl7VuFQETER+VwHkEqcB/wOdAR+KRY+yZg
nDGmMhABXAfssNYmXNjAGLMfuPdyO1EhEBHxUTlcYmIOsNQYkwKcBx4FMMY8A+y11r5rjHkVSCF/
zXfEJY4OumKQKgQiIj7Kc5ftCWXW2hzgN5f4+dQizxcACy7zHj+70n4cV6hoFeNsCREJdWVyr8/7
n9hZqs/I9xYkBuU9R684IujSf3d5xFHm3pl7LedWzQ10GH4T0ak//963N9Bh+MXPGjdhy56TV97w
KnBj05p80b5toMPwi5+v+5QTJ84GOgy/iI+PvfJGPtC1hkREQpwKgYhIiPPneQSBpEIgIuIjjQhE
REKc16MRgYhISNOIQEQkxHm1RiAiEtrK+oSy8qJCICLiI00NiYiEOE0NiYiEOI0IRERCXMrK24Py
2kGlpVtVioiEOBUCEZEQp0IgIhLiVAhEREKcCoGISIhTIRARCXEqBCIiIU6FQEQkxKkQiIiEOBUC
EQkIr9fLiRPfFj6XwNElJkQkIEaMeJacnGymTZuNw1EhrtRw1dKIQEQCokOHuzhx4lu2b98a6FBC
ngqBiJQbr9fL7NnTWb/+Y1q2bIXDEcbXX1sAPBXk/r9XIxUCESk3R44cZtOmjYwY8Sx//evrhIe7
+NOfFnHs2FHCwvRxFCj6Py8i5aZBg2uYP38pr746lyNHDuNyhZOWlsYXX2wCNCoIFC0Wi0i5Cg8P
p2XLViQkNCUzM5MxY17go4/+RadOXTUqCBD9XxeRgIiOjqF27To0bWrIyDhNTk5OoEMKWSoEIhIw
OTk5nDt3jueee4HIyMhAhxOyNDUkIgETGRnJs8+OwOXSR1EgaUQgIgGlIhB4KgQiIiFOhUBEJMSp
EIiIhDgVAhGREKdCICIS4lQIRERCnAqBiEiIUyEQEQlxKgQiIiFOhUBEJMSpEIiIhDgVAhGREKdC
ICIS4lQIRERCnAqBiEiIUyEQEQlxKgQiIiFOhUBEJMQ5vF5voGMQEZEA0ohARCTEqRCIiIQ4FQIR
kRCnQiAiEuJUCEREQpwKgYhIiPv/0yxy0OrkI8YAAAAASUVORK5CYII=
">

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see the correlations are not huge, but some variables have a higher correlation than others.</p>
<p>Let's select the 20 features with the largest correlation and then use cross-validation to evaluate the performance of our choice.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">



<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre><span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">n_vars</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>

<span class="n">select3</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">X_three</span> <span class="o">=</span> <span class="n">select3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">()</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_three</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;Scores on each subset:&quot;</span>
<span class="k">print</span> <span class="n">scores</span>
<span class="n">avg</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">),</span> <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span> <span class="s">&quot;Average score and uncertainty: (</span><span class="si">%.2f</span><span class="s"> +- </span><span class="si">%.3f</span><span class="s">)</span><span class="si">%%</span><span class="s">&quot;</span><span class="o">%</span><span class="k">avg</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>Scores on each subset:
[ 0.6275  0.605   0.5625  0.6125  0.635 ]
Average score and uncertainty: (60.85 +- 1.133)%
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="huzzah">Huzzah!</h2>
<p>Machine learning is magic! Using features which have no bearing what so ever on the class labels we managed to predict the correct class in about 60% of cases, 10% better than what would be expected from random guessing.</p>
<p>Can you spot where we cheated?</p>
<h2 id="doing-it-the-right-way">Doing it the Right Way</h2>
<p>There is no way to beat logic. None of the features contains any information about the class labels, afterall they were choosen at random. So how did we manage to outperform guessing? We cheated when we selected the features we use to train our classifier. We used the full data to find the two features with the highest correlation with the labels and used those.</p>
<p>If you want cross validation to give you an unbiased estimated of your true performance any and all your choices about features, hyper-parameters and the like have to be performed within the cross validation loop.</p>
<p>Here is how to do it right:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">



<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">SelectKBest</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                    <span class="n">GradientBoostingClassifier</span><span class="p">())</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;Scores on each subset:&quot;</span>
<span class="k">print</span> <span class="n">scores</span>
<span class="n">avg</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">),</span> <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span> <span class="s">&quot;Average score and uncertainty: (</span><span class="si">%.2f</span><span class="s"> +- </span><span class="si">%.3f</span><span class="s">)</span><span class="si">%%</span><span class="s">&quot;</span><span class="o">%</span><span class="k">avg</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>Scores on each subset:
[ 0.485   0.5     0.5375  0.5175  0.5075]
Average score and uncertainty: (50.95 +- 0.785)%
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once you include your choice of the 20 best variables in your cross validation pipeline, everything is back to normal.</p>
<p>No one, not even super smart ensembles of decision trees can perform miracles. If your labels are unrelated to the features, you might as well just guess.</p>
<h2 id="take-home-message">Take Home Message</h2>
<p>Choosing your input features is just one of the many choices you have to make when building your machine-learning application. Remember to make all decisions during the cross validation, otherwise you are in for a rude awakening when your model is confronted with unseen data for the first time.</p>
<p>If you find a mistake or want to tell me something else get in touch on twitter @<a href="//twitter.com/betatim">betatim</a></p>
</div></p>
<p>This post started life as a ipython notebook,
<a href="/downloads/notebooks/cross_validation.ipynb">download it</a>
or
<a href="http://nbviewer.ipython.org/url/betatim.github.io//downloads/notebooks/cross_validation.ipynb">view it</a> online.</p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

      </div>
    </div>

<div class="container">
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <footer class="footer">
	<div class="social">
	    <a href="https://github.com/betatim"><i class="fa fa-github fa-2x"></i></a>
	    <a href="https://twitter.com/betatim"><i class="fa fa-twitter fa-2x"></i></a>
	    <a href="mailto:betatim@gmail.com"><i class="fa fa-envelope fa-2x"></i></a>
	</div>
	<div class="powered-by">
	  Copyright ©  2014-2015  - Tim Head - <a href="http://docs.getpelican.com/" target="_blank">Pelican</a> powered.
	</div>
      </footer>
    </div>
  </div>
</div>    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/theme/js/bootstrap.min.js"></script>
  </body>
</html>